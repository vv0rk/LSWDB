

CREATE VIEW [web50repOutOfWarranty] AS SELECT TOP 1000000 tsysAssetTypes.AssetTypeIcon10 As icon, tblAssets.AssetID, tblAssets.AssetName, tblAssetCustom.Serialnumber, tblAssetCustom.PurchaseDate AS [Purchase Date], tblAssetCustom.Warrantydate AS [Warranty Expiration], tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tsysAssetTypes.AssetTypename As Type, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen FROM tblAssetCustom INNER JOIN tblAssets ON tblAssetCustom.AssetID = tblAssets.AssetID INNER JOIN tsysAssetTypes ON tsysAssetTypes.AssetType = tblAssets.Assettype Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID WHERE (tblAssetCustom.Warrantydate < GETDATE()) AND (tblAssetCustom.State = 1) ORDER BY [Warranty Expiration] DESC