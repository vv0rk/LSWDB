CREATE VIEW dbo.web50rep0eea124f500840b1a8e4afdf68b853a2 AS Select Top 1000000 tblAssets.AssetID As Id, tblAssetCustom.Custom1 As Организация, tblAssetCustom.Custom2 As Город, tblAssetCustom.Custom3 As Адрес, tblAssetCustom.Custom4 As Кабинет, tblAssetCustom.Custom5 As Место, tsysAssetTypes.AssetTypename As [Тип устройства], tblAssetCustom.Manufacturer As Производитель, tblAssetCustom.Model As Модель, tblAssetCustom.Serialnumber As [Серийный номер], tblAssetCustom.Custom7 As [Инв номер], tblAssets.AssetName, tblAssetCustom.Custom6 As Владелец, tblState.Statename As Состояние, tblAssets.Username, tsysIPLocations.IPLocation As [Место положения], tblAssets.IPAddress, tblAssetCustom.Custom8 As [Номенклатурный номер], tblAssetCustom.Custom9 As [Инв. номер 2 (Фильш)], rc.Parent As [Родительская организация], os.Caption As [Операционная система], adu.name As [ФИО пользователя], tblAssets.Domain As [Домен ПК], tblAssetCustom.Comments As Comments, tblAssets.Mac As MACaddress, tblAssets.Processor As CPU, tblAssets.Memory As Memory, tblAssetCustom.Custom10 As Должность, tblAssetCustom.Custom11 As ФИО, tblAssetCustom.Custom19 As N'Ответств ВТшник', cs.Name As N'Куст', tblAssetCustom.Custom20 As N'Отв. подразделение' From tblAssets Left Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Left Join tsysIPLocations On tsysIPLocations.StartIP <= tblAssets.IPNumeric And tsysIPLocations.EndIP >= tblAssets.IPNumeric Left Join tsysAssetTypes On tsysAssetTypes.AssetType = tblAssets.Assettype Inner Join tblState On tblState.State = tblAssetCustom.State Left Join rCompany$ As rc On dbo.tblAssetCustom.Custom1 = rc.Code Left Join tblOperatingsystem As os On dbo.tblAssetCustom.AssetID = os.AssetID Left Join (Select adu.Username As username, adu.Name As name From tblADusers As adu Inner Join (Select Distinct adu.Username As username, Max(adu.ADUserID) As id From tblADusers As adu Group By adu.Username) As addu On adu.ADUserID = addu.id) As adu On tblAssets.Username = adu.username Left Join rCompanyCustLink As ccl On tsysIPLocations.LocationID = ccl.IdIPLocations Left Join rCompanyCust As cs On ccl.IdCust = cs.Id Order By [Операционная система], Организация, Город, Адрес, Кабинет, Место, [Тип устройства] Desc