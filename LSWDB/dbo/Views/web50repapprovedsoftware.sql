

CREATE VIEW [web50repapprovedsoftware] AS SELECT TOP 1000000 tblAssets.AssetID, tblAssets.AssetName, tblSoftwareUni.softwareName AS Software, tblSoftwareUni.SoftwarePublisher, tblSoftware.Lastchanged, tblAssets.Domain, tsysAssetTypes.AssetTypename As Type, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen, tsysAssetTypes.AssetTypeIcon10 As icon FROM tblSoftware INNER JOIN tblAssets ON tblSoftware.AssetID = tblAssets.AssetID INNER JOIN tblSoftwareUni ON tblSoftware.softID = tblSoftwareUni.SoftID INNER JOIN tblAssetCustom ON tblAssets.AssetID = tblAssetCustom.AssetID INNER JOIN tsysOS ON tblAssets.OScode = tsysOS.OScode LEFT JOIN tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID Inner Join tsysAssetTypes On tsysAssetTypes.AssetType = tblAssets.Assettype WHERE (tblSoftwareUni.Approved = 1) AND (tblAssetCustom.State = 1) ORDER BY tblAssets.AssetName, Software