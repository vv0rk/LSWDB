

CREATE VIEW web50repdeviceoowarranty as Select Top 1000000 tsysAssetTypes.AssetTypeIcon10 As icon, tblAssetCustom.AssetID, tblAssets.AssetName, tblAssetCustom.Serialnumber, tblAssetCustom.PurchaseDate As [Purchase Date], tblAssetCustom.Warrantydate As [Warranty Expiration], tblAssets.IPAddress, tsysAssetTypes.AssetTypename, tblAssetCustom.Model, tblAssetCustom.Manufacturer, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen From tblAssetCustom Inner Join tblAssets On tblAssetCustom.AssetID = tblAssets.AssetID Inner Join tsysAssetTypes On tsysAssetTypes.AssetType = tblAssets.Assettype Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID Where tblAssetCustom.Warrantydate < GetDate() And tblAssetCustom.State = 1 And tblAssets.Assettype <> -1 Order By [Warranty Expiration] Desc