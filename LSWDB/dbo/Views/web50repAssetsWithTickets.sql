

CREATE VIEW [web50repAssetsWithTickets] AS SELECT TOP 1000000 tblAssets.AssetID, tblAssets.AssetName, COUNT(htblticketasset.ticketid) AS Tickets, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen FROM tblAssets INNER JOIN htblticketasset ON tblAssets.AssetID = htblticketasset.assetid LEFT OUTER Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID LEFT OUTER Join tsysOS On tsysOS.OScode = tblAssets.OScode Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID GROUP BY tblAssets.AssetID, tblAssets.AssetName, tblAssets.Lastseen, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen