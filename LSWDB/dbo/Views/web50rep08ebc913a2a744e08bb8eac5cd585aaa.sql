CREATE VIEW dbo.web50rep08ebc913a2a744e08bb8eac5cd585aaa AS Select Top 1000000 tblAssets.Mac As Mac, Count(tblAssets.Mac) As CountMACaddress, tblAssets.Lastseen, tblAssets.AssetName, tblOperatingsystem.Caption, tblAssets.AssetID As id From tblAssets Left Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Left Join tsysIPLocations On tsysIPLocations.StartIP <= tblAssets.IPNumeric And tsysIPLocations.EndIP >= tblAssets.IPNumeric Left Join tsysAssetTypes On tsysAssetTypes.AssetType = tblAssets.Assettype Inner Join tblState On tblState.State = tblAssetCustom.State Left Join rCompany$ As rc On dbo.tblAssetCustom.Custom1 = rc.Code Left Join tblOperatingsystem As os On dbo.tblAssetCustom.AssetID = os.AssetID Left Join (Select adu.Username As username, adu.Name As name From tblADusers As adu Inner Join (Select Distinct adu.Username As username, Max(adu.ADUserID) As id From tblADusers As adu Group By adu.Username) As addu On adu.ADUserID = addu.id) As adu On tblAssets.Username = adu.username Inner Join tblOperatingsystem On tblAssets.AssetID = tblOperatingsystem.AssetID Where tsysAssetTypes.AssetTypename = 'Windows' Group By tblAssets.Mac, tblAssets.Lastseen, tblAssets.AssetName, tblOperatingsystem.Caption, tblAssets.AssetID Order By CountMACaddress Desc