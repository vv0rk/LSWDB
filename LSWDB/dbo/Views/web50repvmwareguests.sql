

CREATE VIEW [web50repvmwareguests] AS SELECT TOP 1000000 tblAssets.AssetID, tblAssets.AssetName, tblVmwareInfo.Version, tblVmwareGuest.Name AS Guest, tblVmwareGuest.Memory, tblVmwareGuest.IsRunning AS State, tsysAssetTypes.AssetTypeIcon10 AS icon, tblVmwareGuest.lastchanged, tblAssets.Domain, tsysAssetTypes.AssetTypename As Type, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen FROM tblAssets INNER JOIN tblVmwareGuest ON tblAssets.AssetID = tblVmwareGuest.AssetID INNER JOIN tsysAssetTypes ON tblAssets.Assettype = tsysAssetTypes.AssetType INNER JOIN tblVmwareInfo ON tblAssets.AssetID = tblVmwareInfo.AssetID Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID Inner Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID ORDER BY tblAssets.AssetName, tblVmwareGuest.Name