

CREATE VIEW [web50repunratedsoftware] AS SELECT TOP 1000000 tsysOS.Image As icon, tblAssets.AssetID, tblAssets.AssetName, tblSoftwareUni.softwareName AS Software, tblSoftware.softwareVersion AS Version, tblSoftware.Lastchanged, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tsysOS.OSname As OS, tblAssets.SP As SP, tblAssets.Firstseen, tblAssets.Lastseen FROM tblSoftware INNER JOIN tblAssets ON tblSoftware.AssetID = tblAssets.AssetID INNER JOIN tblSoftwareUni ON tblSoftware.softID = tblSoftwareUni.SoftID INNER JOIN tblAssetCustom ON tblAssets.AssetID = tblAssetCustom.AssetID INNER JOIN tsysOS ON tblAssets.OScode = tsysOS.OScode LEFT JOIN tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID WHERE (tblSoftwareUni.Approved = 0) AND (tblAssetCustom.State = 1) ORDER BY tblAssets.AssetName, Software