CREATE VIEW dbo.web50rep57801aa9a25a4670b359af9514d116c2 AS Select Top 1000000 a2.AssetID, a2.AssetName, a2.Firstseen, a2.Mac, ac.Custom19 From tblAssets As a2 Inner Join tblAssetCustom As ac On a2.AssetID = ac.AssetID Where a2.AssetName Like 'delete-%' And Not Exists(Select a.AssetName From tblAssets As a Inner Join tblAssets As a1 On a.Mac = a1.Mac Where a1.AssetID != a.AssetID And a.Firstseen > a1.Firstseen And a.AssetName Like 'delete-%' And a.AssetName = a2.AssetName And a.Mac != '' And a.Mac Is Not Null)