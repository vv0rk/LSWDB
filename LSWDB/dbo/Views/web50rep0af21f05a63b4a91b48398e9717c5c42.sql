CREATE VIEW dbo.web50rep0af21f05a63b4a91b48398e9717c5c42 AS Select Top 1000000 a.AssetID, a.AssetID As Id, ac.Custom1 As Организация, ac.Custom2 As Город, ac.Custom3 As Адрес, ac.Custom11 As [ФИО пользователя], t.AssetTypename, a.AssetName, ac.Custom19 As [Ответственный ВТшник], l.IPLocation From tblAssets As a Inner Join tblAssetCustom As ac On a.AssetID = ac.AssetID Inner Join tsysAssetTypes As t On t.AssetType = a.Assettype Inner Join tblState On tblState.State = ac.State Left Join tblOperatingsystem As os On ac.AssetID = os.AssetID Left Join tsysIPLocations As l On l.StartIP <= a.IPNumeric And l.EndIP >= a.IPNumeric Where (ac.Custom2 = N'' Or ac.Custom2 Is Null) And (t.AssetTypename = 'Windows' Or t.AssetTypename = 'Printer') And tblState.Statename Like N'%active%' And Not os.Caption Like N'%server%' Order By Организация, Город, Адрес Desc