CREATE VIEW dbo.web40repprinteroutoftoner AS Select Top 1000000 tsysAssetTypes.AssetTypeIcon10 As icon, tblAssetCustom.Custom1 As Организация, tblAssetCustom.Custom2 As Город, tblAssetCustom.Custom3 As Адрес, tblAssetCustom.Custom4 As Офис, tblAssetCustom.Custom5 As Место, tblAssetCustom.Serialnumber As [Серийный номер], tblAssetCustom.Custom7 As [Инв номер], tblAssetCustom.Custom19 As [ФИО ответственного ВТшника], tblAssets.AssetName, tblAssetCustom.Model As [Device  model], tblAssets.AssetID, tblCustDevPrinter.TonerRemaining, tblCustDevPrinter.TonerMaximum, tblCustDevPrinter.Tonername, tblCustDevPrinter.Lastchanged From tblCustDevPrinter Inner Join tblAssets On tblCustDevPrinter.AssetID = tblAssets.AssetID Inner Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Inner Join tsysAssetTypes On tblAssets.Assettype = tsysAssetTypes.AssetType Where tblCustDevPrinter.TonerRemaining = 0 And tblCustDevPrinter.TonerMaximum > 0 And tblAssetCustom.State = 1 Order By tblCustDevPrinter.TonerRemaining