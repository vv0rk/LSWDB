

CREATE VIEW [web50repusbdrive] AS SELECT TOP 1000000 tsysOS.Image As icon, tblAssets.AssetID, tblAssets.AssetName, tblFloppy.Manufacturer AS [Drive Manufacturer], tblFloppy.Model AS [Drive Model], tblFloppy.Size, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tsysOS.OSname As OS, tblAssets.SP As SP, tblAssets.Firstseen, tblAssets.Lastseen FROM tblAssets INNER JOIN tblAssetCustom ON tblAssets.AssetID = tblAssetCustom.AssetID INNER JOIN tblFloppy ON tblAssets.AssetID = tblFloppy.AssetID LEFT OUTER JOIN tsysOS ON tblAssets.OScode = tsysOS.OScode Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID WHERE (tblAssetCustom.State = 1) AND (tblFloppy.InterfaceType = N'USB') ORDER BY tblAssets.AssetName ASC