
CREATE view [dbo].[web40repofficeserial] AS SELECT      TOP 1000000 dbo.tblAssets.AssetID, dbo.tblAssets.AssetName , dbo.tblAssets.Domain, tbl2.softwareName, tbl3.Product,                          tbl3.ProductID, tbl3.ProductKey FROM          dbo.tblAssets LEFT OUTER JOIN                             (SELECT      tblSoftware.AssetID, tblsoftwareuni.softwareName                               FROM           tblAssets INNER JOIN                                                       tblSoftware ON tblAssets.AssetID = tblSoftware.AssetID INNER JOIN                                                       tblsoftwareuni ON tblsoftwareuni.SoftID = tblSoftware.softID                               WHERE       tblsoftwareuni.softwareName LIKE '%microsoft office%' AND tblsoftwareuni.softwareName NOT LIKE '%visio%' AND                                                        tblsoftwareuni.softwareName NOT LIKE '%meeting%' AND tblsoftwareuni.softwareName NOT LIKE '%interface%') tbl2 ON                          dbo.tblAssets.AssetID = tbl2.AssetID LEFT OUTER JOIN                             (SELECT      tblSerialnumber.AssetID, tblSerialnumber. Product, tblSerialnumber.ProductID, tblSerialnumber.ProductKey                               FROM           tblAssets INNER JOIN                                                       tblSerialnumber ON tblAssets.AssetID = tblSerialnumber.AssetID                               WHERE       tblSerialnumber. Product LIKE '%office%') tbl3 ON dbo.tblAssets.AssetID = tbl3.AssetID WHERE      (tbl2.softwareName IS NOT NULL) ORDER BY dbo.tblAssets.AssetName