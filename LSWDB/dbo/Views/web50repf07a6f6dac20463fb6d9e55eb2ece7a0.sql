CREATE VIEW dbo.web50repf07a6f6dac20463fb6d9e55eb2ece7a0 AS Select distinct TOP 1000000 n.AssetID, aa.AssetName, ac.Custom1 As Организация, ac.Custom2 As Город, ac.Custom3 As Адрес, ac.Custom4 As Офис, ac.Custom19 As 'Ответственный ВТшник', n.MACaddress From (Select a.MACaddress From (Select Distinct n.AssetID, n.MACaddress From tblAssets As a Inner Join tblNetwork As n On a.AssetID = n.AssetID Inner Join tsysAssetTypes As at On a.Assettype = at.AssetType Where n.MACaddress Is Not Null And n.MACaddress <> '' And at.AssetTypename = 'Windows') As a Group By a.MACaddress Having count(*) > 1 And count(*) < 3) As a Inner Join tblNetwork As n On a.MACaddress = n.MACaddress Inner Join tblAssetCustom As ac On n.AssetID = ac.AssetID Inner Join tblAssets As aa On ac.AssetID = aa.AssetID