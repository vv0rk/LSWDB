

CREATE VIEW [web50repEncryptableVolumes] AS SELECT TOP 1000000 tsysAssetTypes.AssetTypeIcon16 AS icon, tblAssets.AssetID, tblAssets.AssetName, tblEncryptableVolume.DriveLetter, CASE WHEN tblEncryptableVolume.ProtectionStatus = 0 THEN 'OFF' WHEN tblEncryptableVolume.ProtectionStatus = 1 THEN 'ON' ELSE 'UNKNOWN' END AS ProtectionStatus, tblEncryptableVolume.LastChanged, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tsysOS.OSname As OS, tblAssets.SP As SP, tblAssets.Firstseen, tblAssets.Lastseen FROM tblEncryptableVolume INNER JOIN tblAssets ON tblEncryptableVolume.AssetId = tblAssets.AssetID INNER JOIN tsysAssetTypes ON tblAssets.Assettype = tsysAssetTypes.AssetType Inner Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Inner Join tsysOS On tsysOS.OScode = tblAssets.OScode Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID ORDER BY tblAssets.AssetName asc