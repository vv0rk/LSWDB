

CREATE VIEW [web50rephypervguests] AS SELECT TOP 1000000 tblAssets.AssetID, tblAssets.AssetName, tblHyperVGuest.Name AS Guest, tblHyperVGuest.Memory, tblHyperVGuest.Enabledstate, tblHyperVGuest.Healthstate, tblHyperVGuest.Lastchanged, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tsysOS.OSname As OS, tblAssets.SP As SP, tblAssets.Firstseen, tblAssets.Lastseen, tsysOS.Image AS icon FROM tblAssets INNER JOIN tblHyperVGuest ON tblAssets.AssetID = tblHyperVGuest.AssetID INNER JOIN tsysOS ON tblAssets.OScode = tsysOS.OScode Inner Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID ORDER BY tblAssets.AssetName