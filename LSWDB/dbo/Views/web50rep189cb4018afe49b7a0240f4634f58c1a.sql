CREATE VIEW dbo.web50rep189cb4018afe49b7a0240f4634f58c1a AS Select Top 1000000 a.AssetName As 'Название ИС', Count(arc.AssetName) As 'Зависит от числа серверов' From tblAssets As a Inner Join tblAssetCustom As ac On a.AssetID = ac.AssetID Inner Join tsysAssetTypes On tsysAssetTypes.AssetType = a.Assettype Left Join tblAssetRelations As ar On ac.AssetID = ar.ParentAssetID Left Join tblAssets As arc On ar.ChildAssetID = arc.AssetID Where tsysAssetTypes.AssetTypename = N'ИС' Group By a.AssetName Order By 2 Desc