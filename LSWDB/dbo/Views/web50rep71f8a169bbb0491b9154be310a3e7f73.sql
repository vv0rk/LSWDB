CREATE VIEW dbo.web50rep71f8a169bbb0491b9154be310a3e7f73 AS Select Top 1000000 a.AssetID As Id, ac.Custom1 As Организация, ac.Custom2 As Город, ac.Custom3 As Адрес, t.AssetTypename, a.AssetName, ac.Custom19 As [Ответственный ВТшник], l.IPLocation From tblAssets As a Inner Join tblAssetCustom As ac On a.AssetID = ac.AssetID Inner Join tsysAssetTypes As t On t.AssetType = a.Assettype Left Join tsysIPLocations As l On l.StartIP <= a.IPNumeric And l.EndIP >= a.IPNumeric Where (ac.Custom2 = N'' Or ac.Custom2 Is Null) And (t.AssetTypename = 'Windows' Or t.AssetTypename = 'Printer') Order By t.AssetTypename, [Ответственный ВТшник] Desc