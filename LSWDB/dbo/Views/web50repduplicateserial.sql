

CREATE VIEW [web50repduplicateserial] as SELECT tsysAssetTypes.AssetTypeIcon10 As icon, tblAssets.AssetID, tblAssets.AssetName, tblAssetCustom.Serialnumber, tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tsysAssetTypes.AssetTypename As Type, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen FROM tblAssets INNER JOIN tblAssetCustom ON tblAssets.AssetID = tblAssetCustom.AssetID INNER JOIN tsysAssetTypes ON tblAssets.Assettype = tsysAssetTypes.AssetType INNER JOIN (SELECT COUNT(AssetID) AS Total, COALESCE (Serialnumber, N'') AS Serial FROM tblAssetCustom WHERE (State = 1) GROUP BY COALESCE (Serialnumber, N'') HAVING (COUNT(AssetID) > 1) AND (COALESCE (Serialnumber, N'') <> '')) AS Dups ON tblAssetCustom.Serialnumber = Dups.Serial Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID WHERE (tblAssetCustom.State = 1)