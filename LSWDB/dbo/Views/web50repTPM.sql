

CREATE VIEW [web50repTPM] AS SELECT TOP 1000000 tsysAssetTypes.AssetTypeIcon16 AS icon, tblAssets.AssetID, tblAssets.AssetName, tblTPM.SpecVersion, tblTPM.ManufacturerVersion, tblTPM.ManufacturerVersionInfo, CASE WHEN tblTPM.IsActivated_InitialValue = 1 THEN 'Yes' ELSE 'No' END AS Activated, CASE WHEN tblTPM.IsEnabled_InitialValue = 1 THEN 'Yes' ELSE 'No' END AS Enabled, CASE WHEN tblTPM.IsOwned_InitialValue = 1 THEN 'Yes' ELSE 'No' END AS Owned, tblTPM.PhysicalPresenceVersionInfo,tblAssets.Domain, tblAssets.Username, tblAssets.Userdomain, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tsysOS.OSname As OS, tblAssets.SP As SP, tblAssets.Firstseen, tblAssets.Lastseen FROM tblTPM INNER JOIN tblAssets ON tblTPM.AssetId = tblAssets.AssetID INNER JOIN tsysAssetTypes ON tblAssets.Assettype = tsysAssetTypes.AssetType Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID Inner Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Inner Join tsysOS On tsysOS.OScode = tblAssets.OScode