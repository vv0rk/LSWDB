

CREATE VIEW [web50repWarrantyStatus] AS Select Top 1000000 tsysAssetTypes.AssetTypeIcon16 As icon,tblAssets.AssetID, tblAssets.AssetName, tblWarranty.PurchaseCountry, tblWarranty.ShipDate, tblWarrantyDetails.WarrantyStartDate, tblWarrantyDetails.WarrantyEndDate, tblWarrantyDetails.ServiceType, Case When GetDate() > tblWarrantyDetails.WarrantyEndDate Then 'yes' Else 'no' End As Expired, tblWarranty.Error, tblAssets.Domain, tsysAssetTypes.AssetTypename As Type, tblAssets.IPAddress, tblAssets.Description, tblAssetCustom.Manufacturer, tblAssetCustom.Model, tblAssetCustom.Location, tsysIPLocations.IPLocation, tblAssets.Firstseen, tblAssets.Lastseen From tblWarranty Inner Join tblWarrantyDetails On tblWarranty.WarrantyId = tblWarrantyDetails.WarrantyId Inner Join tblAssets On tblWarranty.AssetId = tblAssets.AssetID Inner Join tsysAssetTypes On tblAssets.Assettype = tsysAssetTypes.AssetType Inner Join tblAssetCustom On tblAssets.AssetID = tblAssetCustom.AssetID Left Join tsysIPLocations ON tblAssets.LocationID = tsysIPLocations.LocationID Where Not (tblWarranty.LastWarrantySuccess Is Null) Order By tblAssets.AssetName, tblWarrantyDetails.WarrantyEndDate Desc